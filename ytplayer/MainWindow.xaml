<Window x:Class="ytplayer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ytplayer"
        xmlns:common="clr-namespace:common"
        mc:Ignorable="d"
        AllowDrop="True"
        Drop="Window_Drop"
        PreviewDragOver="Window_PreviewDragOver"
        Loaded="OnLoaded"
        Unloaded="OnUnloaded"
        Closing="OnClosing"
        Title="MainWindow" Height="450" Width="800">
    <Window.Resources>
        <ResourceDictionary Source="res/YtpResource.xaml"/>
    </Window.Resources>
    <Grid x:Name="RootGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>      <!-- ToolBar -->
            <RowDefinition Height="3*" MinHeight="100"/>         <!-- ListView -->
            <RowDefinition Height="Auto"/>       <!-- Splitter -->
            <RowDefinition Height="1*"/>          <!-- Outputs -->
            <RowDefinition Height="Auto"/>      <!-- StatusBar -->
        </Grid.RowDefinitions>

        <!-- ######## ツールバー ######## -->
        <Grid Grid.Row="0" Background="{StaticResource ToolBarBG}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left">
                <StackPanel.Resources>
                    <Path x:Key="PathDownload" Data="M8 17V15H16V17H8M16 10L12 14L8 10H10.5V6H13.5V10H16M12 2C17.5 2 22 6.5 22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2M12 4C7.58 4 4 7.58 4 12C4 16.42 7.58 20 12 20C16.42 20 20 16.42 20 12C20 7.58 16.42 4 12 4Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathAutoDownload" Data="M5 20H14V18H5M19 9H15V3H9V9H5L12 16M22 16A1.08 1.08 0 0 1 23 17V21A1.08 1.08 0 0 1 22 22H17A1.08 1.08 0 0 1 16 21V17A1.08 1.08 0 0 1 17 16V14.5A2.5 2.5 0 0 1 22 14.5V16M21 16V14.5A1.5 1.5 0 0 0 18 14.5V16H21" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathSound" Data="M21,3V15.5A3.5,3.5 0 0,1 17.5,19A3.5,3.5 0 0,1 14,15.5A3.5,3.5 0 0,1 17.5,12C18.04,12 18.55,12.12 19,12.34V6.47L9,8.6V17.5A3.5,3.5 0 0,1 5.5,21A3.5,3.5 0 0,1 2,17.5A3.5,3.5 0 0,1 5.5,14C6.04,14 6.55,14.12 7,14.34V6L21,3Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathReload" Data="M2 12C2 16.97 6.03 21 11 21C13.39 21 15.68 20.06 17.4 18.4L15.9 16.9C14.63 18.25 12.86 19 11 19C4.76 19 1.64 11.46 6.05 7.05C10.46 2.64 18 5.77 18 12H15L19 16H19.1L23 12H20C20 7.03 15.97 3 11 3C6.03 3 2 7.03 2 12Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathClipboard" Data="M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathMovie" Data="M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathPlay" Data="M8,5.14V19.14L19,12.14L8,5.14Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathExcellent" Data="M18.9,18.94L15.94,16C15.76,15.79 15.55,15.5 15.55,15.05A1.3,1.3 0 0,1 16.85,13.75C17.19,13.75 17.53,13.89 17.77,14.15L18.91,15.26L20.03,14.13C20.27,13.89 20.61,13.75 20.95,13.75A1.3,1.3 0 0,1 22.25,15.05C22.25,15.39 22.11,15.73 21.87,15.97L18.9,18.94M17.46,19.62C15.72,21.1 13.47,22 11,22A10,10 0 0,1 1,12A10,10 0 0,1 11,2A10,10 0 0,1 21,12C21,12.09 21,12.17 20.95,12.25C20.21,12.25 19.5,12.55 18.97,13.07L18.9,13.14L18.84,13.09C18.32,12.55 17.6,12.25 16.85,12.25A2.8,2.8 0 0,0 14.05,15.05C14.05,15.78 14.34,16.5 14.87,17.03L17.46,19.62M13,9.5C13,10.3 13.7,11 14.5,11C15.3,11 16,10.3 16,9.5C16,8.7 15.3,8 14.5,8C13.7,8 13,8.7 13,9.5M9,9.5C9,8.7 8.3,8 7.5,8C6.7,8 6,8.7 6,9.5C6,10.3 6.7,11 7.5,11C8.3,11 9,10.3 9,9.5M12.94,15.18L14,14.12L11.88,12L10.82,13.06L11.88,14.12L10.82,15.18L11.88,16.24L10.82,17.3L11.88,18.36L14,16.24L12.94,15.18Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathGood" Data="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M8.88,7.82L11,9.94L9.94,11L8.88,9.94L7.82,11L6.76,9.94L8.88,7.82M12,17.5C9.67,17.5 7.69,16.04 6.89,14H17.11C16.31,16.04 14.33,17.5 12,17.5M16.18,11L15.12,9.94L14.06,11L13,9.94L15.12,7.82L17.24,9.94L16.18,11Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathNormal" Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,9.5C7,8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5M12,17.23C10.25,17.23 8.71,16.5 7.81,15.42L9.23,14C9.68,14.72 10.75,15.23 12,15.23C13.25,15.23 14.32,14.72 14.77,14L16.19,15.42C15.29,16.5 13.75,17.23 12,17.23M15.5,11C14.7,11 14,10.3 14,9.5C14,8.7 14.7,8 15.5,8C16.3,8 17,8.7 17,9.5C17,10.3 16.3,11 15.5,11Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathBad" Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,9.5V8L10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5M14.77,17.23C14.32,16.5 13.25,16 12,16C10.75,16 9.68,16.5 9.23,17.23L7.81,15.81C8.71,14.72 10.25,14 12,14C13.75,14 15.29,14.72 16.19,15.81L14.77,17.23M17,9.5C17,10.3 16.3,11 15.5,11C14.7,11 14,10.3 14,9.5L17,8V9.5Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    <Path x:Key="PathDreadful" Data="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M6.76,8.82L7.82,7.76L8.88,8.82L9.94,7.76L11,8.82L9.94,9.88L11,10.94L9.94,12L8.88,10.94L7.82,12L6.76,10.94L7.82,9.88L6.76,8.82M6.89,17.5C7.69,15.46 9.67,14 12,14C14.33,14 16.31,15.46 17.11,17.5H6.89M17.24,10.94L16.18,12L15.12,10.94L14.06,12L13,10.94L14.06,9.88L13,8.82L14.06,7.76L15.12,8.82L16.18,7.76L17.24,8.82L16.18,9.88L17.24,10.94Z" Stretch="Fill" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                </StackPanel.Resources>

                <ToggleButton
                    IsChecked="{Binding AutoDownload.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathAutoDownload}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Auto Download"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>

                <ToggleButton
                    IsChecked="{Binding ClipboardWatching.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathClipboard}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Clipboard Watching"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>

                <Grid Width="10"/>
                <ToggleButton
                    IsChecked="{Binding OnlySound.Value, Mode=TwoWay, Converter={StaticResource NegBoolConverter}}" 
                    Content="{StaticResource PathMovie}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Download Movie"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>
                
                <ToggleButton
                    IsChecked="{Binding OnlySound.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathSound}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Download Audio"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>

                <Grid Width="10"/>
                <Button 
                    Content="{StaticResource PathDownload}" Style="{StaticResource PushButtonStyle}"
                    Command="{Binding CommandDownloadNow}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Download Selected"/>
                    </ToolTipService.ToolTip>
                </Button>
                <Button 
                    Content="{StaticResource PathPlay}" Style="{StaticResource PushButtonStyle}"
                    Command="{Binding CommandPlay}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Play"/>
                    </ToolTipService.ToolTip>
                </Button>

                <ComboBox MinWidth="150" Margin="10,2" ItemsSource="{Binding Categories}"
                          SelectedItem="{Binding CurrentCategory.Value, Mode=TwoWay}">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Viewbox Width="20" Height="20">
                                    <Canvas Width="24" Height="24">
                                        <Path Fill="{Binding Brush}" Data="{Binding SvgPath}"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Text="{Binding Label}" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="14"/>
                            </StackPanel>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <ToggleButton 
                    IsChecked="{Binding RatingFilter.Dreadful.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathDreadful}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Filter: Dreadful"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>
                <ToggleButton 
                    IsChecked="{Binding RatingFilter.Bad.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathBad}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Filter: Bad"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>
                <ToggleButton 
                    IsChecked="{Binding RatingFilter.Normal.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathNormal}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Filter: Normal"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>
                <ToggleButton 
                    IsChecked="{Binding RatingFilter.Good.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathGood}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Filter: Good"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>
                <ToggleButton 
                    IsChecked="{Binding RatingFilter.Excellent.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathExcellent}" 
                    Style="{StaticResource ToggleButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Filter: Excellent"/>
                    </ToolTipService.ToolTip>
                </ToggleButton>

                <!--<Button 
                    Content="{StaticResource PathReload}" Style="{StaticResource PushButtonStyle}"
                    Command="{Binding CommandReload}"
                    >
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Start Download"/>
                    </ToolTipService.ToolTip>
                </Button>-->


                <!--<Button Content="{StaticResource PathDownload}" Style="{StaticResource PushButtonStyle}">
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Auto Download"/>
                    </ToolTipService.ToolTip>
                </Button>-->

                <!--<common:CheckButton 
                    Command="{Binding CommandAutoDownload}" IsChecked="{Binding AutoDownload.Value, Mode=TwoWay}" 
                    Content="{StaticResource PathDownload}" 
                    Style="{StaticResource CheckButtonStyle}">
                
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Auto Download"/>
                    </ToolTipService.ToolTip>
                </common:CheckButton>-->
            </StackPanel>
            <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Right">
                <StackPanel.Resources>
                    <Path x:Key="PathSettings" Data="M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                </StackPanel.Resources>
                <Button 
                    Content="{StaticResource PathSettings}" Style="{StaticResource PushButtonStyle}"
                    Command="{Binding CommandSettings}"
                    IsEnabled="{Binding IsBusy.Value, Converter={StaticResource NegBoolConverter}}"
                    >
                    <ToolTipService.ToolTip>
                        <ToolTip Content="Download Selected"/>
                    </ToolTipService.ToolTip>
                </Button>
            </StackPanel>
        </Grid>

        <!-- ######## リスト ######## -->
        <Grid Grid.Row="1" Background="Yellow">
            <Grid.Resources>
                <Style x:Key="StatusIconStyle" TargetType="Path">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=Status}" Value="REGISTERED">
                            <Setter Property="Data" Value="M19,1L17.74,3.75L15,5L17.74,6.26L19,9L20.25,6.26L23,5L20.25,3.75M9,4L6.5,9.5L1,12L6.5,14.5L9,20L11.5,14.5L17,12L11.5,9.5M19,15L17.74,17.74L15,19L17.74,20.25L19,23L20.25,20.25L23,19L20.25,17.74"/>
                            <Setter Property="Fill" Value="SkyBlue"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Status}" Value="RESERVED">
                            <Setter Property="Data" Value="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"/>
                            <Setter Property="Fill" Value="Orange"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Status}" Value="DOWNLOADING">
                            <Setter Property="Data" Value="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"/>
                            <Setter Property="Fill" Value="Orange"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Status}" Value="DOWNLOADED">
                            <Setter Property="Data" Value="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/>
                            <Setter Property="Fill" Value="#00C000"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Status}" Value="FAILED">
                            <Setter Property="Data" Value="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                            <Setter Property="Fill" Value="Red"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Status}" Value="CANCELLED">
                            <Setter Property="Data" Value="M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z"/>
                            <Setter Property="Fill" Value="Red"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Status}" Value="DELETED">
                            <Setter Property="Data" Value="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"/>
                            <Setter Property="Fill" Value="Red"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
                <Style x:Key="RatingIconStyle" TargetType="Path">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="NORMAL">
                            <Setter Property="Data" Value="M20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12M22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12M10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5C7,8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5M17,9.5C17,10.3 16.3,11 15.5,11C14.7,11 14,10.3 14,9.5C14,8.7 14.7,8 15.5,8C16.3,8 17,8.7 17,9.5M12,17.23C10.25,17.23 8.71,16.5 7.81,15.42L9.23,14C9.68,14.72 10.75,15.23 12,15.23C13.25,15.23 14.32,14.72 14.77,14L16.19,15.42C15.29,16.5 13.75,17.23 12,17.23Z"/>
                            <Setter Property="Fill" Value="SlateGray"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="EXCELLENT">
                            <Setter Property="Data" Value="M9,9.5C9,10.3 8.3,11 7.5,11C6.7,11 6,10.3 6,9.5C6,8.7 6.7,8 7.5,8C8.3,8 9,8.7 9,9.5M16,9.5C16,10.3 15.3,11 14.5,11C13.7,11 13,10.3 13,9.5C13,8.7 13.7,8 14.5,8C15.3,8 16,8.7 16,9.5M14,14.12L11.88,12L10.82,13.06L11.88,14.12L10.82,15.18L11.88,16.24L10.82,17.3L11.88,18.36L14,16.24L12.94,15.18L14,14.12M16.85,13A2.05,2.05 0 0,0 14.8,15.05C14.8,15.62 15.03,16.12 15.4,16.5L18.9,20L22.4,16.5C22.77,16.13 23,15.61 23,15.05A2.05,2.05 0 0,0 20.95,13C20.4,13 19.87,13.23 19.5,13.6L18.9,14.2L18.3,13.61C17.93,13.23 17.4,13 16.85,13M15,18.92C13.82,19.6 12.46,20 11,20A8,8 0 0,1 3,12A8,8 0 0,1 11,4C15.26,4 18.73,7.33 19,11.5C19.58,11.19 20.26,11 20.95,11C20.45,5.95 16.18,2 11,2A10,10 0 0,0 1,12A10,10 0 0,0 11,22C13,22 14.88,21.4 16.45,20.38L15,18.92Z"/>
                            <Setter Property="Fill" Value="Red"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="GOOD">
                            <Setter Property="Data" Value="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M13,9.94L14.06,11L15.12,9.94L16.18,11L17.24,9.94L15.12,7.82L13,9.94M8.88,9.94L9.94,11L11,9.94L8.88,7.82L6.76,9.94L7.82,11L8.88,9.94M12,17.5C14.33,17.5 16.31,16.04 17.11,14H6.89C7.69,16.04 9.67,17.5 12,17.5Z"/>
                            <Setter Property="Fill" Value="Orange"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="BAD">
                            <Setter Property="Data" Value="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,9.5C7,8.7 7.7,8 8.5,8C9.3,8 10,8.7 10,9.5C10,10.3 9.3,11 8.5,11C7.7,11 7,10.3 7,9.5M14.77,17.23C14.32,16.5 13.25,16 12,16C10.75,16 9.68,16.5 9.23,17.23L7.81,15.81C8.71,14.72 10.25,14 12,14C13.75,14 15.29,14.72 16.19,15.81L14.77,17.23M15.5,11C14.7,11 14,10.3 14,9.5C14,8.7 14.7,8 15.5,8C16.3,8 17,8.7 17,9.5C17,10.3 16.3,11 15.5,11Z"/>
                            <Setter Property="Fill" Value="DeepSkyBlue"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=Rating}" Value="DREADFUL">
                            <Setter Property="Data" Value="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2M6.76,8.82L7.82,7.76L8.88,8.82L9.94,7.76L11,8.82L9.94,9.88L11,10.94L9.94,12L8.88,10.94L7.82,12L6.76,10.94L7.82,9.88L6.76,8.82M6.89,17.5C7.69,15.46 9.67,14 12,14C14.33,14 16.31,15.46 17.11,17.5H6.89M17.24,10.94L16.18,12L15.12,10.94L14.06,12L13,10.94L14.06,9.88L13,8.82L14.06,7.76L15.12,8.82L16.18,7.76L17.24,8.82L16.18,9.88L17.24,10.94Z"/>
                            <Setter Property="Fill" Value="MediumBlue"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Resources>
            <ListView x:Name="MainListView" ItemsSource="{Binding MainList.Value}" 
                  GridViewColumnHeader.Click="OnHeaderClick">
                <ListView.Resources>
                    <DataTemplate x:Key="SortHeaderTemplate">
                        <DockPanel>
                            <Image Width="10" Height="10" DockPanel.Dock="Right" Margin="5,0,0,0">
                                <Image.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=GridViewColumnHeader}}" Value="asc">
                                                <Setter Property="Image.Source" Value="{StaticResource AscImageSource}"/>
                                                <Setter Property="Image.Visibility" Value="Visible"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=GridViewColumnHeader}}" Value="desc">
                                                <Setter Property="Image.Source" Value="{StaticResource DescImageSource}"/>
                                                <Setter Property="Image.Visibility" Value="Visible"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=GridViewColumnHeader}}" Value="">
                                                <Setter Property="Image.Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Image.Style>
                            </Image>
                            <TextBlock Foreground="DarkBlue">
                                <TextBlock.Text>
                                    <Binding/>
                                </TextBlock.Text>
                            </TextBlock>
                        </DockPanel>
                    </DataTemplate>
                </ListView.Resources>
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <EventSetter Event="MouseDoubleClick" Handler="OnListItemDoubleClick"/>
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                        <Setter Property="Tag"
                            Value="{Binding DataContext, RelativeSource={RelativeSource AncestorType=ListView}}" />
                        <Setter Property="ContextMenu">
                            <Setter.Value>
                                <!-- ListViewのTagにセットしておいたWindow#DataContextを、ContextMenuのデータコンテキストにセットするセットしておく -->
                                <ContextMenu DataContext="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                    <MenuItem Header="Reset &amp; Download" Command="{Binding ResetAndDownloadCommand}" CommandParameter="{Binding PlacementTarget.Content, RelativeSource={RelativeSource AncestorType=ContextMenu}}"/>
                                    <MenuItem Header="Delete &amp; Block" Command="{Binding DeleteAndBlockCommand}" CommandParameter="{Binding PlacementTarget.Content, RelativeSource={RelativeSource AncestorType=ContextMenu}}"/>
                                </ContextMenu>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="URL" Width="100" DisplayMemberBinding="{Binding Url}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>
                        <GridViewColumn Header="Name" Width="100" DisplayMemberBinding="{Binding NameToDisplay}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>
                        <GridViewColumn Header="Status" Width="40" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Viewbox Width="20" Height="20">
                                        <Canvas Width="24" Height="24">
                                            <Path Style="{StaticResource StatusIconStyle}"/>
                                        </Canvas>
                                    </Viewbox>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Rating" Width="40" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Viewbox Width="20" Height="20">
                                        <Canvas Width="24" Height="24">
                                            <Path Style="{StaticResource RatingIconStyle}"/>
                                        </Canvas>
                                    </Viewbox>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn Header="Category" Width="80" DisplayMemberBinding="{Binding Category}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>

                        <GridViewColumn Header="Date" Width="80" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Date, Converter={StaticResource DateStringConverter}}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn Header="Media" Width="80" HeaderTemplate="{StaticResource SortHeaderTemplate}">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Viewbox Width="20" Height="20" Visibility="{Binding Media, Converter={StaticResource MediaFlagToVisibilityConverter}, ConverterParameter=video}">
                                            <Canvas Width="24" Height="24" Margin="0,5,0,-5">
                                                <Path Data="M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z" 
                                                      Stretch="Uniform" Fill="#B080FF"/>
                                            </Canvas>
                                        </Viewbox>
                                        <Viewbox Width="18" Height="18" Visibility="{Binding Media, Converter={StaticResource MediaFlagToVisibilityConverter}, ConverterParameter=audio}">
                                            <Canvas Width="24" Height="24" Margin="0,2,0,-2">
                                                <Path Data="M21,3V15.5A3.5,3.5 0 0,1 17.5,19A3.5,3.5 0 0,1 14,15.5A3.5,3.5 0 0,1 17.5,12C18.04,12 18.55,12.12 19,12.34V6.47L9,8.6V17.5A3.5,3.5 0 0,1 5.5,21A3.5,3.5 0 0,1 2,17.5A3.5,3.5 0 0,1 5.5,14C6.04,14 6.55,14.12 7,14.34V6L21,3Z" 
                                                  Stretch="Uniform" Fill="#40FFA0"/>
                                            </Canvas>
                                        </Viewbox>
                                    </StackPanel>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn Header="Desc" Width="50" DisplayMemberBinding="{Binding Desc}" HeaderTemplate="{StaticResource SortHeaderTemplate}"/>
                    </GridView>
                </ListView.View>
            </ListView>
        </Grid>
        
        <GridSplitter Grid.Row="2" Height="3" HorizontalAlignment="Stretch" Background="{StaticResource ToolBarBG}"/>

        <!-- ######## アウトプット ######## -->
        <Grid Grid.Row="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" Background="{StaticResource ToolBarBG}" Margin="0" HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0" Margin="10,0,10,0">
                    <TextBlock Grid.Column="0" Text="Output" Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,4,0">
                    <StackPanel.Resources>
                        <Path x:Key="PathTrash" Data="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                        <Path x:Key="PathFold" Data="M12,17L7,12H10V8H14V12H17L12,17M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3M5,5V19H19V5H5Z" Stretch="Uniform" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ButtonBase}}"/>
                    </StackPanel.Resources>
                    <Button 
                        Content="{StaticResource PathTrash}" Style="{StaticResource SmallPushButtonStyle}"
                        Command="{Binding CommandClearOutput}">
                        <ToolTipService.ToolTip>
                            <ToolTip Content="Clear"/>
                        </ToolTipService.ToolTip>
                    </Button>
                    <Button 
                        Content="{StaticResource PathFold}" Style="{StaticResource SmallPushButtonStyle}"
                        Command="{Binding CommandFoldOutput}">
                        <ToolTipService.ToolTip>
                            <ToolTip Content="Minimize"/>
                        </ToolTipService.ToolTip>
                    </Button>

                </StackPanel>
            </Grid>
            <ListView Grid.Row="1" x:Name="OutputListView" ItemsSource="{Binding OutputList}">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Message}" Foreground="{Binding Color}"/>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>

        <!-- ######## ステータスバー ######## -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" Background="{StaticResource ToolBarBG}">
            <TextBlock Text="{Binding StatusString}" Foreground="White"/>
        </StackPanel>

        <!-- ######## ダイアログ ######## -->
        <Grid Grid.Row="0" Grid.RowSpan="5" 
              Background="#50000000"
              Visibility="{Binding DialogActivated.Value, Converter={StaticResource BoolVisibilityConverter}}" 
              >
            <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Background="#0040FF" HorizontalAlignment="Stretch">
                    <TextBlock Text="{Binding DialogTitle.Value}" Foreground="White" Margin="10,4" HorizontalAlignment="Left"/>
                </Grid>
                <Grid Grid.Row="1" Background="#FFFFFF">
                    <Grid Visibility="{Binding DialogType.Value, Converter={StaticResource EnumVisibilityConverter}, ConverterParameter=DELETE_COMFIRM}"
                          Margin="10"
                          >
                        <StackPanel Orientation="Vertical">
                            <TextBlock Text="Delete Selected Item(s)?"/>
                            <CheckBox Content="Delete item(s) from list." Margin="5,5,0,0"/>
                            <CheckBox Content="Delete download file(s)." Margin="5,5,0,0"/>
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="OK" Command="{Binding CommandOk}" Width="100" Margin="0,0,10,0"/>
                                <Button Content="Cancel" Width="100" Command="{Binding CommandCancel}" Margin="0,0,10,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                    <Grid Visibility="{Binding DialogType.Value, Converter={StaticResource EnumVisibilityConverter}, ConverterParameter=ACCEPT_DETERMINATION}"
                          Margin="10"
                          >
                        <StackPanel Orientation="Vertical">
                            <TextBlock Text="Unknown host ..."/>
                            <Border BorderThickness="1" BorderBrush="LightGray" Margin="0,5">
                                <TextBlock Text="{Binding DeterminationDialog.Host.Value}" Margin="2"/>
                            </Border>
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="Accept" Command="{Binding CommandOk}" Width="100" Margin="0,0,10,0"/>
                                <Button Content="Reject" Width="100" Command="{Binding CommandCancel}" Margin="0"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Window>
